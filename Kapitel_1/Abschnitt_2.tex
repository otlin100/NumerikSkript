\subsection{Ordnung von Quadraturformeln}

\begin{definition}
Eine Quadraturformel (QF) mit Gewichten und Knoten $(b_i, c_i)_{i=1}^{s}$ hat \textbf{Ordnung p}, falls sie exakt ist für alle Polynome von Grad $ \leq p-1$.\\
$$\mathcal{P} := \left\{ \sum_{i=0}^{n}a_iX^i, a_i \in \mathbb{R} (\mathbb{C}) \right\}, \quad \text{Menge aller Polynome}  $$
Für $q \in \mathcal{P}$ ist $\text{deg}(q)$ der Grad des Polynoms.
\end{definition}

\begin{theorem}
Ein QF $(b_i, c_i)_{i=1}^{s}$ für $[0,1]$ hat Ordnung $p$ genau dann, wenn

$$\sum_{i=1}^{s} b_i c_i^{q-1} = \frac{1}{q}$$ für $q = 1,..,p$.
\begin{proof}[Beweis]
\begin{description}
  \item
\end{description}
\begin{description}
  \item $"\Rightarrow"$ \\
  QF hat Ordnung p $\Rightarrow$ QF ist exakt für $g(t) = t^{q-1}$ für $q = 1,..,p$ auf $[0,1]$ \\
  $\Rightarrow$ $$\sum b_i c_i^{q-1} = \int_{0}^{1} t^{q-1} dt = \left[\frac{t^q}{q}\right]_{t=0}^{1} = \frac{1}{q}$$
  \item $"\Leftarrow"$\\
  Jedes Polynom von Grad $p-1$ lässt sich als Linearkombination von $1, t, t^2, ...,t^{p-1}$. Die Behauptung folgt aus der Linearität in $g$ von $$\int_{0}^{1} g(t) dt$$ und $$\sum_{i=1}^{s}b_i g(c_i)$$
\end{description}
\end{proof}
\end{theorem}

\begin{example}
\begin{description}
  \item
\end{description}

\begin{enumerate}
  \item Rechtecksregel: $p=1$
  \item Mittelpunktsregel: $p=2$
  \item Trapezregel: $p=2$
  \item Simpsonregel: $p \geq 3$ nach Konstruktion \\
  \begin{align*}
  q &= 4: \quad \frac{1}{6} * 0^3 + \frac{4}{6} * \left(\frac{1}{2}\right)^3 + \frac{1}{6}*1^3 = \frac{1}{4} &\\
  q &= 5: \quad \frac{1}{6} * 0^4 + \frac{4}{6} * \left(\frac{1}{2}\right)^4 + \frac{1}{6}*1^4 = \frac{5}{24} \neq \frac{1}{5}&\\
  \end{align*}
  Nach Satz (2.2) ist damit die Ordnung der Simpsonregel $p=4$.
  \item "pulcherina et utilissima": Übung
\end{enumerate}
\end{example}

\begin{comment}
Zu vergebenen paarweise verschiedenen Knoten $c_1, ..., c_s$ lässt sich mit Satz (2.2) für $p=s$ ein lineares Gleichungssystem für die Gewichte $b_1, ..., b_s$ aufstellen.\\

$$
\underbrace{\left[ \begin{array}{rrrr}
1 & 1 & ... & 1 \\
c_1 & c_2 & ... & c_s \\
... & ... & ... & ... \\
c_1^{s-1} & c_2^{s-1} & ... & c_s^{s-1} \\
\end{array}\right]}_{= V}
*
\left[ \begin{array}{r}
b_1 \\
b_2 \\
... \\
b_s \\
\end{array}\right] 
= 
\left[ \begin{array}{r}
1 \\
1/2 \\
... \\
1/s \\
\end{array}\right] 
$$
Falls die Vandermonde-Matrix V invertierbar ist, so lassen sich die Gewichte $b_1, ..., b_s$ bestimmen, sodass die QF $(b_i, c_i)_{i = 1}^{s}$ mindestens Ordnung $s$ hat.
\end{comment}

\begin{definition}
Eine QF heißt symmetrisch, falls für $i = 1,...,s$ gilt:
\begin{enumerate}
  \item $c_i = 1 - c_{s+1-i}$
  \item $b_i = b_{s+1-i}$
\end{enumerate}
\end{definition}

\begin{example}[Symmetrische QF]
Mittelpunktsregel, Trapezregel, Simpsonregel,...
\end{example}

\begin{theorem}
Die maximal erreichbare Ordnung einer symmetrischen QF ist gerade.
\begin{proof}[Beweis]
Sei die QF $(b_i,c_i)_{i=1}^{s}$ exakt for Polynome vom Grad $\leq 2m-2$ (für $m \in \mathbb{N}$), (dann ist die Ordnung $\geq 2m-1$).
$$\forall g \in \mathcal{P}: deg(g) \leq 2m-2 \Rightarrow \sum_{i=1}^{s} b_i g(c_i) = \int_{0}^{1} g(t) dt$$
Sei $f \in \mathcal{P}$ mit $deg(f) = 2m-1$. \\
Wir zeigen QF ist exakt für $f$. 
$$f(t) = ct^{2m-1} + g(t)$$
für $g \in \mathcal{P}$ mit $deg(g) \leq 2m-2$ mit $c \neq 0$. \\
Trick: $f(t) = c(t-\frac{1}{2})^{2m-1} + \tilde{g}(t)$ mit $\tilde{g} \in \mathcal{P}$ und $deg(\tilde{g}) \leq 2m-2$

\begin{enumerate}
  \item Für $\tilde{g}$ ist die QF exakt
  \item $$\int_0^1 \left(t-\frac{1}{2}\right)^{2m-1} dt = \left[\frac{1}{2m-2}\left(t-\frac{1}{2}\right)^{2m-2}\right]_0^1 = 0$$
  $$ \sum_{i=1}^{s} b_i \left(c_i - \frac{1}{2}\right)^{2m-1}$$ 
  Symmetrie $\Rightarrow$
  $$= \sum_{i=1}^{s} b_{s+1-i} \left(\frac{1}{2} - c_{s+1-i}\right)^{2m-1} $$
  Definiere $j := s+1-i$
  $$ = \sum_{i=1}^{s} b_i \left(\frac{1}{2} - c_i\right)^{2m-1} = -\sum_{i=1}^{s} b_i \left(c_i - \frac{1}{2}\right)^{2m-1}$$
  $$\Rightarrow 2*\sum_{i=1}^{s} b_i \left(c_i - \frac{1}{2}\right)^{2m-1} = 0$$
  $$\Rightarrow \sum_{i=1}^{s} b_i \left(c_i - \frac{1}{2}\right)^{2m-1} = 0$$
  $$\sum_{i=1}^{s}b_if(c_i) = c \sum_{i=1}^{s}b_i\left(c_i-\frac{1}{2}\right)^{2m-1} + \sum_{i=1}^{s}b_i\tilde{g}(c_i)$$
  $$ = c\int_0^1\left(t-\frac{1}{2}\right)^{2m-1} dt + \int_0^1 \tilde{g}(t)dt = \int_0^1 f(t)dt$$
  $\Rightarrow$ QF hat mind. Ordnung $2m$.
\end{enumerate}
\end{proof}
\end{theorem}

\begin{theorem}
Sind Knoten $c_1 < c_2 < ... < c_s$ ($c_i \in \mathbb{R}, i = 1,...s$) gegeben, so existieren eindeutig bestimmte Gewichte $b_1 ,..., b_s$ derart, dass die QF $(b_i, c_i)_{i=1}^s$ die maximale Ordnung $p \geq s$ hat. \\
Es gilt $$b_i = \int_0^1 l_i(t) dt$$ mit $$l_i(t) = \frac{\prod_{j=1, j\neq i}^s (t-c_j)}{\prod_{j=1, j\neq i}^s (c_i-c_j)}$$

\begin{proof}[Beweis] von 2.8 \\
\begin{enumerate}
  \item Hat die QF die Ordnung $p \geq s$, so ist wegen $deg(l_i) = s-1$:
  $$ \int_0^1 l_i(t) dt = \sum_{j=1}^s b_j l_i(c_j) = b_i$$
  \item Zu den Knoten $c_i, ...c_s$ definiere $b_i$ wie angegeben. Die QF ist dann exakt für alle Polynome von Grad $ \leq s-1$, da die $l_1, ...,l_s$ linear unabhängig sind und eine Basis des Vektorraums der Polynome von Grad $\leq s-1$ bilden.
\end{enumerate}
\end{proof}
\end{theorem}

\begin{comment*}[zu Satz (2.8)]
$l_i$ ist das i-te Lagrangepolynom zu den Knoten $c_1, ...,c_s$. Es gilt:
\begin{enumerate}
  \item $deg(l_i) = s-1$
  \item $l_i(c_j) = \left\{
\begin{array}{ll}
0 & \,i \neq j \\
1 & \, i = j\\
\end{array}
\right. $, für $j=1,...,s$
\end{enumerate}

\end{comment*}
